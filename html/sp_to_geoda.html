<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: sp_to_geoda()</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for sp_to_geoda {rgeoda}"><tr><td>sp_to_geoda {rgeoda}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
sp_to_geoda()
</h2>

<h3>Description</h3>

<p>This function creates a rgeoda object from the sp object.
</p>
<p>The sp package has been an essential tool which provides spatial data-structures and many utility functions to do spatial analysis in R. It has been a core dependent library for many other packages, e.g. rgdal (IO), maptools (mapping), spdep (spatial weights, spatial statistics, and spatial models) etc.
</p>
<p>Using rgdal to read a ESRI Shapefile will return a sp (Spatial object) object, which could be either a SpatialPointsDataFrame (using an AttributeList for its data slot directly), a SpatialLinesDataFrame, or a SpatialPolygonsDataFrame.
</p>


<h3>Usage</h3>

<pre>
sp_to_geoda(sp_obj)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>sp_obj</code></td>
<td>

<p>An instance of sp object
</p>
</td></tr>
</table>


<h3>Value</h3>




<table summary="R valueblock">
<tr valign="top"><td><code>geoda</code></td>
<td>
<p>An instance of GeoDa</p>
</td></tr>
</table>



<h3>Author(s)</h3>

<p>Xun Li (lixun910@gmail.com)
</p>


<h3>References</h3>

<p>https://lixun910.github.io/pygeoda/wn1_rgeoda_sp.html
</p>


<h3>Examples</h3>

<pre>

library(rgeoda)

# In this example, we will use an ESRI Shapefile natregimes.shp comes with the package:
guerry_path &lt;- system.file("extdata", "Guerry.shp", package = "rgeoda")

# Create a sp object from the Guerry.shp file
library(rgdal)
guerry_sp &lt;- readOGR(guerry_path)

# Create a rgeoda object from the sp object guerry_sp you just created.
guerry_gda &lt;- sp_to_geoda(guerry_sp)

# Thatâ€™s it! It should be very fast: rgeoda uses wkb, which is a binary representation of geometries, to exchange data between sp and rgeoda in memory.

# Now, with the rgeoda object guerry_gda, you can call GeoDaâ€™s spatial analysis functions easily. For example, we want to examine the local Moran of variable â€œcrm_prsâ€ (Population per Crime against persons):
queen_w &lt;- guerry_gda$CreateContiguityWeights()
crm_lisa &lt;- guerry_gda$LISA(queen_w, as.numeric(paste(guerry_sp$Crm_prs)))
crm_lisa_clusters &lt;- crm_lisa$GetClusterIndicators()

# Now, with the LISA results, we can do exploratory spatial data analysis by generating a LISA cluster map:
plot(guerry_sp, 
     col=sapply(crm_lisa_clusters, function(x){return(lisa_colors[[x+1]])}), 
     border = "#333333", lwd=0.2)
title(main = "Local Moran Map")
legend('bottomright', legend = lisa_labels, fill = lisa_colors, border = "#eeeeee")

# From the above code, you can see that we still use sp object to do plotting. The values of cluster indicators from rgeodaâ€™s LISA object are used to make the LISA map.This emphasis that rgeoda is a API focused library, which only provides the core functions of spatial data analysis for easy integration.

# You can easily append the lisa results to original sp object by manipulating the data.frame object inside the sp object.

# If you check the values of the cluster indicators, you will see they are integer numbers 0 (not significant), 1 (high-high cluster), 2 (low-low cluster), 3 (low-high cluster), 4 (high-low cluster), 5 (neighborless/island), 6 (undefined), which are excatly the same with GeoDa software when you save LISA results to a table:
crm_lisa_clusters

# We also specify what color is associated with which cluster value to replace the lisa_colors and lisa_labels, which are defined in sf_geoda.R:
lisa_colors &lt;- c("#eeeeee","#FF0000","#0000FF","#a7adf9", "#f4ada8", "#999999")

# We then create an array of hex color, each observation is set to a hex color according to its cluster indicator value.
sapply(crm_lisa_clusters, function(x){return(lisa_colors[[x+1]])})


</pre>

<hr /><div style="text-align: center;">[Package <em>rgeoda</em> version 0.0.1 <a href="00Index.html">Index</a>]</div>
</body></html>
